<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Saúde Bucal - material suplementar</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="03_br_saude_bucal_tese_files/libs/clipboard/clipboard.min.js"></script>
<script src="03_br_saude_bucal_tese_files/libs/quarto-html/quarto.js"></script>
<script src="03_br_saude_bucal_tese_files/libs/quarto-html/popper.min.js"></script>
<script src="03_br_saude_bucal_tese_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="03_br_saude_bucal_tese_files/libs/quarto-html/anchor.min.js"></script>
<link href="03_br_saude_bucal_tese_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03_br_saude_bucal_tese_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03_br_saude_bucal_tese_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="03_br_saude_bucal_tese_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="03_br_saude_bucal_tese_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#procedimentos-metodológicos" id="toc-procedimentos-metodológicos" class="nav-link active" data-scroll-target="#procedimentos-metodológicos">Procedimentos metodológicos</a></li>
  <li><a href="#preparando-ambiente-do-r" id="toc-preparando-ambiente-do-r" class="nav-link" data-scroll-target="#preparando-ambiente-do-r">Preparando ambiente do R</a></li>
  <li><a href="#definição-de-escopo" id="toc-definição-de-escopo" class="nav-link" data-scroll-target="#definição-de-escopo">1. Definição de escopo</a></li>
  <li><a href="#análise-das-necessidades-de-saúde-bucal" id="toc-análise-das-necessidades-de-saúde-bucal" class="nav-link" data-scroll-target="#análise-das-necessidades-de-saúde-bucal">2. Análise das necessidades de saúde bucal</a>
  <ul class="collapse">
  <li><a href="#levantando-a-faixa-etária-p" id="toc-levantando-a-faixa-etária-p" class="nav-link" data-scroll-target="#levantando-a-faixa-etária-p">2.1. Levantando a faixa etária (P)</a></li>
  <li><a href="#plano-de-saúde" id="toc-plano-de-saúde" class="nav-link" data-scroll-target="#plano-de-saúde">2.1.1. Plano de Saúde</a></li>
  <li><a href="#cobertura-de-condições-de-saúde-bucal-h" id="toc-cobertura-de-condições-de-saúde-bucal-h" class="nav-link" data-scroll-target="#cobertura-de-condições-de-saúde-bucal-h">2.2. Cobertura de condições de saúde bucal (H)</a></li>
  <li><a href="#parâmetros-normativos-de-procedimentos-per-capita-s" id="toc-parâmetros-normativos-de-procedimentos-per-capita-s" class="nav-link" data-scroll-target="#parâmetros-normativos-de-procedimentos-per-capita-s">2.3. Parâmetros normativos de procedimentos per capita (S)</a></li>
  </ul></li>
  <li><a href="#tradução-do-número-de-serviços-em-número-de-profissionais-necessários" id="toc-tradução-do-número-de-serviços-em-número-de-profissionais-necessários" class="nav-link" data-scroll-target="#tradução-do-número-de-serviços-em-número-de-profissionais-necessários">3. Tradução do número de serviços em número de profissionais necessários</a></li>
  <li><a href="#exploração-das-implicações-em-termos-de-recursos-como-a-oferta-atual-de-profissionais-e-custos" id="toc-exploração-das-implicações-em-termos-de-recursos-como-a-oferta-atual-de-profissionais-e-custos" class="nav-link" data-scroll-target="#exploração-das-implicações-em-termos-de-recursos-como-a-oferta-atual-de-profissionais-e-custos">4. Exploração das implicações em termos de recursos, como a oferta atual de profissionais e custos</a>
  <ul class="collapse">
  <li><a href="#obtenção-da-oferta-de-profissionais" id="toc-obtenção-da-oferta-de-profissionais" class="nav-link" data-scroll-target="#obtenção-da-oferta-de-profissionais">4.1. Obtenção da oferta de profissionais</a></li>
  <li><a href="#cálculo-de-valor-líquido-da-oferta" id="toc-cálculo-de-valor-líquido-da-oferta" class="nav-link" data-scroll-target="#cálculo-de-valor-líquido-da-oferta">4.2. Cálculo de valor líquido da oferta</a></li>
  <li><a href="#implicações-de-resultados-em-termos-quantitativos" id="toc-implicações-de-resultados-em-termos-quantitativos" class="nav-link" data-scroll-target="#implicações-de-resultados-em-termos-quantitativos">4.3. Implicações de resultados em termos quantitativos</a></li>
  <li><a href="#implicações-de-resultados-em-termos-financeiros" id="toc-implicações-de-resultados-em-termos-financeiros" class="nav-link" data-scroll-target="#implicações-de-resultados-em-termos-financeiros">4.4. Implicações de resultados em termos financeiros</a></li>
  </ul></li>
  <li><a href="#análise-de-cenário" id="toc-análise-de-cenário" class="nav-link" data-scroll-target="#análise-de-cenário">5. Análise de Cenário</a></li>
  <li><a href="#referências" id="toc-referências" class="nav-link" data-scroll-target="#referências">Referências</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Saúde Bucal - material suplementar</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="procedimentos-metodológicos" class="level2">
<h2 class="anchored" data-anchor-id="procedimentos-metodológicos">Procedimentos metodológicos</h2>
<p>A construção do modelo de planejamento da força de trabalho (PDFT) para saúde bucal baseado em necessidades foi elaborado a partir das orientações de Asamani et al.&nbsp;(2021) que sugerem algumas etapas, que serão descritas com maior detalhamento a seguir:</p>
<ol type="1">
<li>Definição de escopo da metodologia em termos de cobertura jurisdicional, objetivos e horizonte temporal;</li>
<li>Análise da necessidade de saúde bucal com base em aspectos da demografia, epidemiologia e serviços destinados da população a local;</li>
<li>Tradução do número de serviços em número de profissionais necessários;</li>
<li>Exploração das implicações em termos de recursos, como a oferta atual de profissionais e custos;</li>
<li>Análise de sensibilidade para simulação de parâmetros de incerteza;</li>
<li>Validação de modelo por meio de consulta a stakeholders.</li>
</ol>
</section>
<section id="preparando-ambiente-do-r" class="level2">
<h2 class="anchored" data-anchor-id="preparando-ambiente-do-r">Preparando ambiente do R</h2>
<p>Carregando os pacotes necessários para o R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RODBC)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geobr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel) </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggspatial) </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geojsonio)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="definição-de-escopo" class="level2">
<h2 class="anchored" data-anchor-id="definição-de-escopo">1. Definição de escopo</h2>
<p>A metodologia tem como objetivo estimar a força de trabalho atual e necessária de cirurgiões dentistas e técnicos e auxilares de saúde bucal para atuação em municípios brasileiros, a nível de atenção primária, em procedimentos de natureza individual, bem como três procedimentos de natureza especializada: endodontia, prótese e periodontia.</p>
</section>
<section id="análise-das-necessidades-de-saúde-bucal" class="level2">
<h2 class="anchored" data-anchor-id="análise-das-necessidades-de-saúde-bucal">2. Análise das necessidades de saúde bucal</h2>
<p>A análise da necessidade de saúde bucal (NSB) foi construída a partir de três elementos: distribuição da população por faixa etária (P), prevalência de condições de saúde bucal (H) e procedimentos per capita (S).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/equacao1_sb.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Onde:</p>
<ul>
<li>NSB = Necessidade de saúde bucal é o número de serviços do tipo t destinados ao atendimento de população de faixa etária i e localidade l;</li>
<li>P = População por faixa-etária i de uma localidade l;</li>
<li>H = Prevalência de condições de saúde bucal que levam à necessidade de procedimentos do tipo t por faixa-etária i e dentro de uma localidade l;</li>
<li>S = Procedimentos per capita do tipo t, para cada faixa-etária i e dentro de uma localidade l.</li>
</ul>
<section id="levantando-a-faixa-etária-p" class="level3">
<h3 class="anchored" data-anchor-id="levantando-a-faixa-etária-p">2.1. Levantando a faixa etária (P)</h3>
<p>A distribuição por faixa etária foi construída com base em dados do último censo (2022) e estão disponíveis na página do IBGE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># leitura dos dados de populacao</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lendo dados do censo </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>pop_brasil <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"~/GitHub/saude_bucal/01_dados/populacao_municipio_censo_completa.xlsx"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tratando para ajustar cada faixa etaria</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>pop_brasil_tratado <span class="ot">&lt;-</span> pop_brasil <span class="sc">|&gt;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(cod_municipiodv, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                         ibge_sb, municipio, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                         de_0_a_14_anos,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                         de_15_a_29_anos, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                         de_30_a_59_anos,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                         acima_de_60_anos) <span class="sc">|&gt;</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"faixa"</span>, </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">value =</span> <span class="st">"total"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">faixa =</span> <span class="fu">gsub</span>(<span class="st">"_"</span>,<span class="st">" "</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                                      faixa)) <span class="sc">|&gt;</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">ibge =</span> <span class="fu">as.character</span>(ibge_sb)) <span class="sc">|&gt;</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">ibge =</span> <span class="fu">substr</span>(ibge_sb, <span class="dv">1</span>, <span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">cod_municipiodv =</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.character</span>(cod_municipiodv)) <span class="sc">|&gt;</span> </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">cod_mun_loc =</span> cod_municipiodv) <span class="sc">|&gt;</span> </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">cod_municipiodv =</span> </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">substr</span>(cod_municipiodv, <span class="dv">1</span>, <span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">id_faixa =</span> </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">case_when</span>(faixa <span class="sc">==</span> <span class="st">"de 0 a 14 anos"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                                     faixa <span class="sc">==</span> <span class="st">"de 15 a 29 anos"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                                     faixa <span class="sc">==</span> <span class="st">"de 30 a 59 anos"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                                     faixa <span class="sc">==</span> <span class="st">"acima de 60 anos"</span> <span class="sc">~</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plotando a informação de faixa etária. Nota-se que a faixa etária com maior frequência é de 30 a 59 anos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ordem <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"de 0 a 14 anos"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"de 15 a 29 anos"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"de 30 a 59 anos"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"acima de 60 anos"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>pop_brasil_tratado<span class="sc">$</span>faixa <span class="ot">&lt;-</span> <span class="fu">factor</span>(pop_brasil_tratado<span class="sc">$</span>faixa, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> ordem)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>pop_brasil_tratado <span class="sc">|&gt;</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> faixa, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> total)) <span class="sc">+</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribuição de faixa etária por município"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_br_saude_bucal_tese_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O censo possui outras divisões de faixa etárias. Utilizamos estas para padronizar com os dados do próximo parâmetro (H), calculado a partir da pesquisa de SB 2010 (subseção seguinte).</p>
</section>
<section id="plano-de-saúde" class="level3">
<h3 class="anchored" data-anchor-id="plano-de-saúde">2.1.1. Plano de Saúde</h3>
<p>A seguir é feito um levantamento de plano de saúde por região de saúde de acordo com dados da ANS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: FALSE</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>hierarquia_municipios <span class="ot">&lt;-</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"~/GitHub/saude_bucal/01_dados/hierarquia_atualizada.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cod_municipio =</span> <span class="fu">as.character</span>(cod_municipio))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5570 Columns: 18
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (12): regiao_pad, regiao, uf_pad, uf, uf_sigla, macrorregiao_pad, macror...
dbl  (6): cod_uf, cod_macrorregiao, cod_regsaud, cod_municipio, cod_municipi...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>plano_de_saude <span class="ot">&lt;-</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_delim</span>(<span class="st">"~/GitHub/saude_bucal/01_dados/plano_de_saude.csv"</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">delim =</span> <span class="st">","</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">escape_double =</span> <span class="cn">FALSE</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim_ws =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id_faixa =</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                FAIXA_CORRIGIDA <span class="sc">==</span> <span class="st">"de 0 a 14 anos"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                FAIXA_CORRIGIDA <span class="sc">==</span> <span class="st">"de 15 a 29 anos"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                FAIXA_CORRIGIDA <span class="sc">==</span> <span class="st">"de 30 a 59 anos"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                FAIXA_CORRIGIDA <span class="sc">==</span> <span class="st">"acima de 60 anos"</span> <span class="sc">~</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id_faixa <span class="sc">!=</span> <span class="st">"NA"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CD_MUNICIPIO =</span> <span class="fu">as.character</span>(CD_MUNICIPIO)) <span class="sc">|&gt;</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CD_MUNICIPIO, id_faixa, PLANO_ODONTO, POP) <span class="sc">|&gt;</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 33630 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): SG_UF, FAIXA_CORRIGIDA
dbl (5): PERIODO, CD_MUNICIPIO, CD_UF, PLANO_ODONTO, POP

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plano_odontologico_rs <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                  plano_de_saude <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">left_join</span>(hierarquia_municipios,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cd_municipio"</span><span class="ot">=</span><span class="st">"cod_municipio"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">group_by</span>(uf, uf_sigla, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                               cod_regsaud,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                               regiao_saude,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                               id_faixa) <span class="sc">|&gt;</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">summarise</span>(<span class="at">benef =</span> <span class="fu">sum</span>(plano_odonto),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">pop =</span> <span class="fu">sum</span>(pop)) <span class="sc">|&gt;</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mutate</span>(<span class="at">cobertura_plano =</span> benef<span class="sc">/</span>pop) <span class="sc">|&gt;</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">filter</span>(pop <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'uf', 'uf_sigla', 'cod_regsaud',
'regiao_saude'. You can override using the `.groups` argument.</code></pre>
</div>
</div>
<p>Vamos agora unir à tabela de população possui.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>relacao_municipio_rs <span class="ot">&lt;-</span> hierarquia_municipios <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">select</span>(cod_municipio,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                                     cod_regsaud)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>populacao_tratado <span class="ot">&lt;-</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  pop_brasil_tratado <span class="sc">|&gt;</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(relacao_municipio_rs,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_municipiodv"</span><span class="ot">=</span><span class="st">"cod_municipio"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plano_odontologico_rs,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_regsaud"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"id_faixa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>benef, <span class="sc">-</span>pop) <span class="sc">|&gt;</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop_sus =</span> total <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> cobertura_plano))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A variável pop_sus será útil para simular os resultados usando a população que não tem acesso a plano de saúde (exclusivamente odontológico).</p>
</section>
<section id="cobertura-de-condições-de-saúde-bucal-h" class="level3">
<h3 class="anchored" data-anchor-id="cobertura-de-condições-de-saúde-bucal-h">2.2. Cobertura de condições de saúde bucal (H)</h3>
<p>O Ministério da Saúde traz uma série de parâmetros para planejamento dos serviços de saúde bucal (Brasil, 2021). Um dos parâmetros é a <strong>cobertura de serviços de saúde</strong>. A cobertura foi calculada a partir da pesquisa SB 2010 para cada faixa etária e tipo de procedimento conforme a lógica expressa abaixo.</p>
<p>Cabe destacar que, devido à estrutura da SB2010, estes parâmetros foram calculados para capitais de cada estado ou interior da região.</p>
<table class="caption-top table">
<caption>Fonte: Brasil (2021)</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Área</th>
<th>Expressões usadas para cálculo de cobertura</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Atenção básica</td>
<td>NT_1 (Número de dentes necessitando de restauração de 1 superfície) + NT_2 (Número de dentes necessitando de restauração de 2 ou mais superfícies) + NT_6 (Número de dentes necessitando de extração) + NT_7 (Número de dentes necessitando de controle de lesão branca) + NT_8 (Número de dentes necessitando de selante) + P_CALC (Prevalência de cálculo) + P_BR (Prevalência de bolsa rasa). Foi então criada a variável COB_AB. Se COB_AB = 0 o indivíduo não necessita de procedimentos de atenção básica, se COB_AB =1 ele necessita. A cobertura de atenção básica foi então estimada pelo percentual de pessoas com COB_AB=1</td>
</tr>
<tr class="even">
<td>Endodontia</td>
<td>A cobertura de endodontia foi calculada a partir da variável NT_5 (Número de dentes necessitando de tratamento pulpar + restauração). Foi criada a variável ENDO onde ENDO=0 se NT_5=0 e ENDO=1 se NT_5≠0. Desta forma, a cobertura de endodontia foi então estimada pelo percentual de pessoas com ENDO=1</td>
</tr>
<tr class="odd">
<td>Periodontia especializada</td>
<td>A cobertura de periodontia especializada foi estimada pelo percentual de pessoas com a variável P_BP (Prevalência de bolsa profunda) = 1</td>
</tr>
<tr class="even">
<td>Prótese</td>
<td>A cobertura de prótese foi calculada pelo percentual de pessoas com a variável NECPROT (Necessidade geral de prótese) ≠ 0</td>
</tr>
</tbody>
</table>
<p>A cobertura de saúde bucal para cada condição e faixa etária são apresentados abaixo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lendo dados </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>cobertura_sb <span class="ot">&lt;-</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(<span class="st">"~/GitHub/saude_bucal/01_dados/cobertura sb.xlsx"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sheet =</span> <span class="st">"Cobertura"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ibge =</span> <span class="fu">substr</span>(ibge, <span class="dv">1</span>, <span class="dv">6</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># apresentando dados</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>cobertura_sb <span class="sc">|&gt;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ibge,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>id_faixa,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>li_cobertura, </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>ls_cobertura)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 512 × 4
   municipio   procedimento   faixa_etaria cobertura
   &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;            &lt;dbl&gt;
 1 Porto Velho Atenção Básica 0 a 14 anos      0.69 
 2 Porto Velho Endodontia     0 a 14 anos      0.074
 3 Porto Velho Periodontia    0 a 14 anos      0    
 4 Porto Velho Prótese        0 a 14 anos      0    
 5 Rio Branco  Atenção Básica 0 a 14 anos      0.625
 6 Rio Branco  Endodontia     0 a 14 anos      0.071
 7 Rio Branco  Periodontia    0 a 14 anos      0    
 8 Rio Branco  Prótese        0 a 14 anos      0    
 9 Manaus      Atenção Básica 0 a 14 anos      0.661
10 Manaus      Endodontia     0 a 14 anos      0.138
# ℹ 502 more rows</code></pre>
</div>
</div>
<p>Considerando os dados de população (P) e de cobertura (H), temos os seguintes resultados para população coberta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tratando os dados devido ao padrao de codigo IBGE de 7 digitos em algumas bases</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>populacao_tratado <span class="ot">&lt;-</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  populacao_tratado <span class="sc">|&gt;</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ibge_sb =</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">as.character</span>(ibge_sb)) <span class="sc">|&gt;</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ibge_sb =</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_sub</span>(ibge_sb, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">start =</span> <span class="dv">1</span>, </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">end =</span> <span class="dv">6</span>)) </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>cobertura_sb<span class="sc">$</span>ibge <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cobertura_sb<span class="sc">$</span>ibge)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># juntando base de populacao e cobertura de saude bucal</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>pop_coberta_br <span class="ot">&lt;-</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  populacao_tratado <span class="sc">|&gt;</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cobertura_sb, </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ibge_sb"</span> <span class="ot">=</span> <span class="st">"ibge"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"id_faixa"</span> <span class="ot">=</span> <span class="st">"id_faixa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ibge, ibge_sb, </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>         municipio.x, </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>         faixa, id_faixa, </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>         total, procedimento, cobertura, cobertura_plano,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>         pop_sus, cod_municipiodv, cod_mun_loc) <span class="sc">|&gt;</span> </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">municipio =</span> municipio.x) <span class="sc">|&gt;</span> </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cobertura_servicos =</span> cobertura) <span class="sc">|&gt;</span> </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">populacao_coberta =</span> cobertura_servicos <span class="sc">*</span> total) <span class="sc">|&gt;</span> </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">populacao_coberta =</span> <span class="fu">round</span>(populacao_coberta, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">populacao_coberta_sus =</span> cobertura_servicos <span class="sc">*</span> pop_sus) <span class="sc">|&gt;</span> </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">populacao_coberta_sus =</span> <span class="fu">round</span>(populacao_coberta_sus, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(populacao_tratado, cobertura_sb, by = c(ibge_sb = "ibge", : Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 1 of `x` matches multiple rows in `y`.
ℹ Row 121 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
</section>
<section id="parâmetros-normativos-de-procedimentos-per-capita-s" class="level3">
<h3 class="anchored" data-anchor-id="parâmetros-normativos-de-procedimentos-per-capita-s">2.3. Parâmetros normativos de procedimentos per capita (S)</h3>
<p>Os cálculos de necessidade normativa por procedimento per capita (S) estão disponíveis nos parâmetros do Ministério da Saúde e são baseados na pesquisa de Saúde Bucal (SB 2010).</p>
<table class="caption-top table">
<caption>Fonte: Brasil (2021)</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 94%">
</colgroup>
<thead>
<tr class="header">
<th>Área</th>
<th>Procedimentos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Atenção básica</td>
<td><p>No banco de dados do projeto SB BRASIL 2010 foram transformados os códigos 0 (hígido), A (não examinado) e X (excluído) das variáveis CPI17, CPI11, CPI 27, CPI37, CPI31 e CPI47 em 0 e em 1 para as variáveis que tivessem o código 2 (cálculo) e 3 (bolsa rasa).</p>
<p>Ao final essas variáveis foram somadas e a variável NECPERIO_AB criada para armazenar esta soma.</p>
<p>Foram somados os valores referentes as variáveis NT_1, NT_2, NT_6, NT_7 e NT_8 formando a variável NEC_AB. Finalmente foram somadas NECPERIO_AB e NEC_AB para se obter a variável NEC_AB_TOTAL.</p>
<p>Foi então obtida a média da variável NEC_AB_TOTAL estratificada por idade e domínios geográficos (capitais e interior).</p></td>
</tr>
<tr class="even">
<td>Endodontia</td>
<td>Foi obtida a média da variável NT_5 (Número de dentes necessitando de tratamento pulpar + restauração) estratificada por idade e domínios geográficos (capitais e interior).</td>
</tr>
<tr class="odd">
<td>Periodontia</td>
<td><p>No banco de dados do projeto SB BRASIL 2010 foram transformados os códigos 0 (hígido), A (não examinado) e X (excluído) das variáveis CPI17, CPI11, CPI 27, CPI37, CPI31 e CPI47 em 0 e em 1 para as variáveis que tivessem o código 4 (bolsa profunda).</p>
<p>Ao final essas variáveis foram somadas e a variável NECPERIO_ESPEC criada para armazenar esta soma.</p>
<p>Foi então obtida a média da variável NECPERIO_ESPEC estratificada por idade e domínios geográficos (capitais e interior). Para as idades de 5 e 12 anos esta variável não foi mensurada no projeto SB BRASIL 2010, portanto não há dados de necessidade normativa para a faixa de 0 a 14 anos.</p></td>
</tr>
<tr class="even">
<td>Prótese</td>
<td><p>A variável NECPROT foi transformada em NUMPROT (número de próteses) como explicitado a seguir:</p>
<ul>
<li>Se NECPROT = 0 (Não necessita), então NUMPROT = 0</li>
<li>Se NECPROT = 1 (Parcial 1 maxilar), então NUMPROT = 1</li>
<li>Se NECPROT = 2 (Parcial 2 maxilares), então NUMPROT = 2</li>
<li>Se NECPROT = 3 (Total 1 maxilar), então NUMPROT = 3</li>
<li>Se NECPROT = 4 (Parcial + total), então NUMPROT = 2</li>
<li>Se NECPROT = 5 (Total 2 maxilares), então NUMPROT = 2</li>
<li>Se NECPROT = 9 (Sem informação), então NUMPROT = 0</li>
</ul>
<p>Foi então obtida a média da variável NUMPROT estratificada por idade e domínios geográficos (capitais e interior).</p>
<p>Para as idades de 5 e 12 anos esta variável não foi mensurada no projeto SB BRASIL 2010, portanto não há dados de necessidade normativa para a faixa de 0 a 14 anos.</p></td>
</tr>
</tbody>
</table>
<p>O código abaixo acessa dados de produção normativa em Palmas-TO, disponível nos parâmetros do Ministério da Saúde.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># leitura do dado de producao normativa (S)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>producao_normativa_br <span class="ot">&lt;-</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(<span class="st">"~/GitHub/saude_bucal/01_dados/cobertura sb.xlsx"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet =</span> <span class="st">"Produção normativa"</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"text"</span>,<span class="st">"text"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"text"</span>,<span class="st">"text"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"numeric"</span>,<span class="st">"numeric"</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ibge =</span> <span class="fu">substr</span>(ibge, <span class="dv">1</span>, <span class="dv">6</span>))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>producao_brasil <span class="ot">&lt;-</span> producao_normativa_br <span class="sc">|&gt;</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(<span class="sc">-</span>municipio, </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                             <span class="sc">-</span>li_cobertura,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                             <span class="sc">-</span>ls_cobertura,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                             <span class="sc">-</span>faixa_etaria)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># juntando populacao coberta e producao normativa para calcular o total de servicos necessarios</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>necessidades_servicos_br <span class="ot">&lt;-</span> pop_coberta_br <span class="sc">|&gt;</span> </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">left_join</span>(producao_brasil, </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ibge"</span> <span class="ot">=</span> <span class="st">"ibge"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"id_faixa"</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"procedimento"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">mutate</span>(<span class="at">nec_servicos =</span> </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                                    populacao_coberta <span class="sc">*</span> producao_pc) <span class="sc">|&gt;</span> </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">mutate</span>(<span class="at">nec_servicos =</span> </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">round</span>(nec_servicos, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">mutate</span>(<span class="at">nec_servicos_sus =</span> </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                                     populacao_coberta_sus <span class="sc">*</span> producao_pc) <span class="sc">|&gt;</span> </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">mutate</span>(<span class="at">nec_servicos_sus =</span> <span class="fu">round</span>(nec_servicos_sus,<span class="dv">2</span>))</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>necessidades_servicos_br <span class="sc">|&gt;</span> </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(municipio, </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>         faixa, </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>         total,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>         procedimento, </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>         nec_servicos,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>         nec_servicos_sus) <span class="sc">|&gt;</span> </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">populacao =</span> total) <span class="sc">|&gt;</span> </span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(faixa, procedimento) <span class="sc">|&gt;</span> </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">populacao =</span> <span class="fu">sum</span>(populacao),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">servicos =</span> <span class="fu">sum</span>(nec_servicos),</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">servicos_sus =</span> <span class="fu">sum</span>(nec_servicos_sus))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
# Groups:   faixa [4]
   faixa            procedimento   populacao   servicos servicos_sus
   &lt;fct&gt;            &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
 1 de 0 a 14 anos   Atenção Básica  41001697  71981199.    67417874.
 2 de 0 a 14 anos   Endodontia      41001697    405112.      379098.
 3 de 0 a 14 anos   Periodontia     41001697         0            0 
 4 de 0 a 14 anos   Prótese         41001697         0            0 
 5 de 15 a 29 anos  Atenção Básica  46121201 124786034.   111764255.
 6 de 15 a 29 anos  Endodontia      46121201    641403.      579714.
 7 de 15 a 29 anos  Periodontia     46121201      9917.        8767.
 8 de 15 a 29 anos  Prótese         46121201   1734770.     1591539.
 9 de 30 a 59 anos  Atenção Básica  86610211 300918456.   239430723 
10 de 30 a 59 anos  Endodontia      86610211    865072.      674932.
11 de 30 a 59 anos  Periodontia     86610211    880860.      705967.
12 de 30 a 59 anos  Prótese         86610211 121367874.    98866375.
13 acima de 60 anos Atenção Básica  31643236  18243746.    16119166.
14 acima de 60 anos Endodontia      31643236     20514.       17893.
15 acima de 60 anos Periodontia     31643236     51160.       44859.
16 acima de 60 anos Prótese         31643236  58942437.    53570762.</code></pre>
</div>
</div>
</section>
</section>
<section id="tradução-do-número-de-serviços-em-número-de-profissionais-necessários" class="level2">
<h2 class="anchored" data-anchor-id="tradução-do-número-de-serviços-em-número-de-profissionais-necessários">3. Tradução do número de serviços em número de profissionais necessários</h2>
<p>A etapa 3 consiste na tradução do número de serviços, calculado pela equação 1, em número de profissionais necessários (NPSB). Para isso, devem ser considerados dois elementos: produtividade (T) e o tempo total disponível (TTD).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/eq2_sb.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Onde:</p>
<ul>
<li>NPSB = Necessidade de profissionais de saúde bucal;</li>
<li>NSB = Necessidade de saúde bucal contabilizada pelo número de serviços do tipo t destinados ao atendimento de população de faixa etária i e localidade l;</li>
<li>T = Tempo médio de serviços do tipo t;</li>
<li>TTD = Tempo total disponível de um profissional ao longo de um ano.</li>
</ul>
<p>Vamos utilizar como tempo médio de consulta (T) o valor de 25 minutos. Esse valor foi baseado em um levantamento utilizando técnicas de time-motion realizado para aferir o tempo médio de procedimentos executados pela equipe de saúde bucal, em unidades básicas de saúde em São Paulo, Brasil (Bellotti et al, 2024).</p>
<p>O tempo total disponível (TTD) corresponde ao tempo de um profissional deduzidas ausências programáticas (ex.: férias, feriados) e não programáticos (ex.: licenças para tratamento de saúde). Vamos utilizar como referência o TTD estimado em 1576 horas, frequentemente usado para enfermeiros. Infelizmente, não temos estudos que já tenham levantado um TTD para profissionais de saúde bucal no Brasil.</p>
<p>Este resultado indica quantos cirurgiões dentistas por mês são necessários ao longo de um ano para cobrir as necessidades da população.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculando a necessidade de profissionais com base no total no tempo medio de procedimentos e TTD</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>necessidades_prof_br <span class="ot">&lt;-</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>            necessidades_servicos_br <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">nec_prof =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                  procedimento <span class="sc">==</span> <span class="st">"Atenção Básica"</span> <span class="sc">~</span> (nec_servicos <span class="sc">*</span> <span class="dv">25</span><span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                  procedimento <span class="sc">==</span> <span class="st">"Endodontia"</span> <span class="sc">~</span> (nec_servicos <span class="sc">*</span> <span class="dv">35</span><span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                  procedimento <span class="sc">==</span> <span class="st">"Periodontia"</span> <span class="sc">~</span> (nec_servicos <span class="sc">*</span> <span class="dv">50</span><span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                  procedimento <span class="sc">==</span> <span class="st">"Prótese"</span> <span class="sc">~</span> (nec_servicos <span class="sc">*</span> <span class="dv">60</span><span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">nec_prof_sus =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                  procedimento <span class="sc">==</span> <span class="st">"Atenção Básica"</span> <span class="sc">~</span> (nec_servicos_sus <span class="sc">*</span> <span class="dv">25</span><span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                  procedimento <span class="sc">==</span> <span class="st">"Endodontia"</span> <span class="sc">~</span> (nec_servicos_sus <span class="sc">*</span> <span class="dv">35</span><span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                  procedimento <span class="sc">==</span> <span class="st">"Periodontia"</span> <span class="sc">~</span> (nec_servicos_sus <span class="sc">*</span> <span class="dv">50</span><span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                  procedimento <span class="sc">==</span> <span class="st">"Prótese"</span> <span class="sc">~</span> (nec_servicos_sus <span class="sc">*</span> <span class="dv">60</span><span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>)) <span class="sc">|&gt;</span>               </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">nivel =</span> <span class="fu">if_else</span>(</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                            procedimento <span class="sc">==</span> <span class="st">"Atenção Básica"</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"APS"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"AES"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">group_by</span>(ibge, municipio, </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                         nivel, cod_municipiodv, </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                         cod_mun_loc) <span class="sc">|&gt;</span> </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summarise</span>(<span class="at">necessidade =</span> <span class="fu">sum</span>(nec_prof),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">necessidade_sus =</span> <span class="fu">sum</span>(nec_prof_sus)) <span class="sc">|&gt;</span> </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">necessidade =</span> <span class="fu">round</span>(necessidade, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">necessidade_sus =</span> <span class="fu">round</span>(necessidade_sus, <span class="dv">2</span>))</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                          </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>                          </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>necessidades_prof_br <span class="sc">|&gt;</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(municipio, </span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>         nivel, </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>         necessidade,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>         necessidade_sus) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,140 × 4
   municipio       nivel necessidade necessidade_sus
   &lt;chr&gt;           &lt;chr&gt;       &lt;dbl&gt;           &lt;dbl&gt;
 1 Porto Velho     AES        138.            113.  
 2 Porto Velho     APS        431.            369.  
 3 Rio Branco      AES        166.            158.  
 4 Rio Branco      APS        221.            212.  
 5 Abaetetuba      AES         62.7            58.9 
 6 Abaetetuba      APS        160.            152.  
 7 Abel Figueiredo AES          2.54            2.2 
 8 Abel Figueiredo APS          5.98            5.23
 9 Abreulândia     AES          2.3             2.09
10 Abreulândia     APS          4.91            4.63
# ℹ 11,130 more rows</code></pre>
</div>
</div>
</section>
<section id="exploração-das-implicações-em-termos-de-recursos-como-a-oferta-atual-de-profissionais-e-custos" class="level2">
<h2 class="anchored" data-anchor-id="exploração-das-implicações-em-termos-de-recursos-como-a-oferta-atual-de-profissionais-e-custos">4. Exploração das implicações em termos de recursos, como a oferta atual de profissionais e custos</h2>
<p>O próximo passo consiste em algumas etapas, sendo elas:</p>
<ol type="1">
<li>Obtenção da oferta de profissionais;</li>
<li>Cálculo de valor líquido da oferta;</li>
<li>Comparação da oferta com necessidades;</li>
</ol>
<section id="obtenção-da-oferta-de-profissionais" class="level3">
<h3 class="anchored" data-anchor-id="obtenção-da-oferta-de-profissionais">4.1. Obtenção da oferta de profissionais</h3>
<p>A oferta de profissionais foi acessada usando o Cadastro Nacional de Estabelecimentos de Saúde - tabela Profissionais (CNES-PF).</p>
<p>Como profissionais podem ter múltiplos vínculos, padronizou-se a contagem por meio do Full-time equivalent (FTE), com base na carga horária de contrato.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># codigo para acessar dados de datalake proprio </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>dremio_host <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"endereco"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>dremio_port <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"port"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>dremio_uid <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"uid"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>dremio_pwd <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">"datalake"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>channel <span class="ot">&lt;-</span> <span class="fu">odbcDriverConnect</span>(<span class="fu">sprintf</span>(<span class="st">"DRIVER=Dremio Connector;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="st">                                     HOST=%s;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="st">                                     PORT=%s;</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="st">                                     UID=%s;</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="st">                                     PWD=%s;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="st">                                     AUTHENTICATIONTYPE=Basic Authentication;</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="st">                                     CONNECTIONTYPE=Direct"</span>, </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                         dremio_host, </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                         dremio_port, </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>                         dremio_uid, </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>                         dremio_pwd))</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">'SELECT * FROM "Analytics Layer".Infraestrutura.Profissionais."TSB e dentistas por municipio"'</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>oferta <span class="ot">&lt;-</span> <span class="fu">sqlQuery</span>(channel, query, </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">as.is =</span> <span class="cn">TRUE</span>) </span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(oferta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18322     7</code></pre>
</div>
</div>
<p>A consulta <code>SQL</code> que gerou esta tabela de dados está descrito abaixo.</p>
<p>Acessamos dados de todos os municípios para a <code>COMPETEN</code> (mês e ano) de janeiro de 2024. Foram acessados dados de Cirurgiões dentistas e Técnicos e Auxiliares de Saúde Bucal. Acessamos registros de profissionais atuantes no SUS e na saúde suplementar a partir da variável <code>PROF_SUS</code>. Para uma primeira análise vamos fazer simulações apenas para o recorte de profissionais SUS.</p>
<p>Foram acessados dados dos seguintes tipos de unidade (<code>TP_UNID</code>):</p>
<ul>
<li>Atenção Primária à Saúde (APS)
<ul>
<li>01 - Posto de saúde</li>
<li>02 - Centro de Saúde/Unidade Básica</li>
<li>32 - Unidade Móvel Fluvial</li>
<li>40 - Unidade Móvel Terrestre</li>
</ul></li>
<li>Atenção Especializada à Saúde (AES)
<ul>
<li>36 - Clínica/Centro de Especialidade</li>
<li>73 - Pronto atendimento</li>
<li>04 - Policlínica</li>
<li>22 - Consultório Isolado</li>
</ul></li>
</ul>
<p>Não foi incluída a força de trabalho atuante em hospitais, tendo em vista o escopo da metodologia.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> PROF <span class="kw">AS</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        CNES,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        CODUFMUN, </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        COMPETEN, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        PROF_SUS, </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span>     </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>              <span class="cf">WHEN</span> TP_UNID <span class="op">=</span> <span class="st">'01'</span> <span class="kw">OR</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                   TP_UNID <span class="op">=</span> <span class="st">'02'</span> <span class="kw">OR</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                   TP_UNID <span class="op">=</span> <span class="st">'32'</span> <span class="kw">OR</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                   TP_UNID <span class="op">=</span> <span class="st">'40'</span> <span class="cf">THEN</span>  <span class="st">'APS'</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>              <span class="cf">WHEN</span> TP_UNID <span class="op">=</span> <span class="st">'36'</span> <span class="kw">OR</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                   TP_UNID <span class="op">=</span> <span class="st">'73'</span> <span class="kw">OR</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>                   TP_UNID <span class="op">=</span> <span class="st">'04'</span> <span class="kw">OR</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                   TP_UNID <span class="op">=</span> <span class="st">'22'</span> <span class="cf">THEN</span> <span class="st">'AES'</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> NIVEL,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">SUBSTR</span>(CBO, <span class="dv">1</span>, <span class="dv">4</span>) <span class="kw">AS</span> FAM_CBO,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">CASE</span> </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="fu">substr</span>(CBO, <span class="dv">1</span>, <span class="dv">4</span>) <span class="op">=</span> <span class="st">'2232'</span> </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">THEN</span> <span class="st">'Cirurgião-dentista'</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">WHEN</span> <span class="fu">substr</span>(CBO, <span class="dv">1</span>, <span class="dv">4</span>) <span class="op">=</span> <span class="st">'3224'</span> </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">THEN</span> <span class="st">'Técnico ou Auxiliar de Saúde Bucal'</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">END</span> CATEGORIA,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>            (HORAOUTR <span class="op">+</span> HORAHOSP <span class="op">+</span> HORA_AMB) <span class="kw">AS</span> ch_total,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>            <span class="fu">CAST</span>((<span class="fu">CAST</span>(HORAOUTR <span class="op">+</span> HORAHOSP <span class="op">+</span> HORA_AMB <span class="kw">AS</span> <span class="dt">FLOAT</span>)<span class="op">/</span><span class="fu">CAST</span>(<span class="dv">40</span> <span class="kw">AS</span> <span class="dt">FLOAT</span>)) <span class="kw">AS</span> <span class="dt">FLOAT</span>) <span class="kw">AS</span> fte40</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> Dados.cnes.PF pf</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> (<span class="fu">substr</span>(CBO, <span class="dv">1</span>, <span class="dv">4</span>) <span class="op">=</span> <span class="st">'2232'</span> <span class="kw">OR</span> </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">substr</span>(CBO, <span class="dv">1</span>, <span class="dv">4</span>) <span class="op">=</span> <span class="st">'3224'</span>) <span class="kw">AND</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>            COMPETEN <span class="op">=</span> <span class="st">'202401'</span> <span class="kw">AND</span> </span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>            NIVEL <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> CODUFMUN, </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>       PROF_SUS, </span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>       NIVEL, </span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>       FAM_CBO, </span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>       CATEGORIA,</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>       <span class="fu">SUM</span>(ch_total) <span class="kw">AS</span> CH,</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>       <span class="fu">ROUND</span>(<span class="fu">SUM</span>(fte40),<span class="dv">2</span>) <span class="kw">AS</span> fte40 </span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> PROF</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> </span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>       CODUFMUN, </span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>       PROF_SUS, </span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>       NIVEL, </span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>       FAM_CBO, </span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>       CATEGORIA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>O script abaixo fazer alguns tratamentos em relação à oferta, pois nem todos os municípios terão profissionais em atenção especializada, por exemplo.</p>
<p>Temos que assegurar que tenhamos 44560 linhas na tabela (5570 municípios x dois níveis de atenção x duas categorias profissionais x dois tipos de vínculo, SUS e não SUS). Por isso é feito o tratamento abaixo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo o vetor com 5570 município</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>vetor <span class="ot">&lt;-</span> <span class="fu">unique</span>(necessidades_prof_br<span class="sc">$</span>cod_municipiodv)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cada elemento do vetor será repetido 8 vezes (2 valores para 'nível', 2 valores para 'profissional' e 2 valores para 'SUS')</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>vetor_duplicado <span class="ot">&lt;-</span> <span class="fu">rep</span>(vetor, <span class="at">each =</span> <span class="dv">8</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a coluna 'nível' com valores alternados entre 'APS' e 'AES'</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>nivel <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"APS"</span>, <span class="st">"AES"</span>), <span class="at">each =</span> <span class="dv">4</span>, <span class="at">length.out =</span> <span class="fu">length</span>(vetor_duplicado))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a coluna 'profissional' com valores alternados entre 'dentista' e 'TSB'</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>profissional <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"2232"</span>, <span class="st">"3224"</span>), <span class="at">each =</span> <span class="dv">2</span>, <span class="at">length.out =</span> <span class="fu">length</span>(vetor_duplicado))</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando a coluna 'SUS' com valores alternados entre 0 e 1</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>SUS <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'0'</span>, <span class="st">'1'</span>), <span class="at">length.out =</span> <span class="fu">length</span>(vetor_duplicado))</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando o DataFrame</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">elemento =</span> vetor_duplicado, </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">nivel =</span> nivel, </span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">profissional =</span> profissional, </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">SUS =</span> SUS</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">ibge =</span> elemento)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ibge <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df<span class="sc">$</span>ibge)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>oferta_brasil <span class="ot">&lt;-</span> </span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">|&gt;</span>  </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(oferta, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ibge"</span><span class="ot">=</span><span class="st">"CODUFMUN"</span>,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"nivel"</span><span class="ot">=</span><span class="st">"NIVEL"</span>,</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"SUS"</span> <span class="ot">=</span> <span class="st">"PROF_SUS"</span>,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"profissional"</span> <span class="ot">=</span> <span class="st">"FAM_CBO"</span>))</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>oferta_brasil<span class="sc">$</span>fte40[<span class="fu">is.na</span>(oferta_brasil<span class="sc">$</span>fte40)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>oferta_brasil<span class="sc">$</span>CH[<span class="fu">is.na</span>(oferta_brasil<span class="sc">$</span>CH)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(oferta_brasil)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44560     7</code></pre>
</div>
</div>
</section>
<section id="cálculo-de-valor-líquido-da-oferta" class="level3">
<h3 class="anchored" data-anchor-id="cálculo-de-valor-líquido-da-oferta">4.2. Cálculo de valor líquido da oferta</h3>
<p>O cálculo do valor líquido da oferta é feito por meio da fórmula 3:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/eq3_sb.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Onde:</p>
<ul>
<li>O = Oferta de profissionais em dada localidade l;</li>
<li>E = Total de profissionais atuantes em estabelecimentos de saúde em dada localidade l;</li>
<li>AD = Percentual da carga de trabalho dedicada a atividades diretas (%);</li>
<li>FC = Percentual da carga de trabalho dedicada a um foco clínico (%)</li>
</ul>
<p>Não temos números associados a AD e FC. Vamos utilizar os valores abaixo, no entanto, já pensando na simulação mais a frente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculando a oferta de profissionais apos deducao de carga de trabalho dedicada a atividades diretas e ao foco clinico. </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>oferta_brasil <span class="ot">&lt;-</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  oferta_brasil <span class="sc">|&gt;</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FTE_40_direto =</span> fte40 <span class="sc">*</span> <span class="fl">0.80</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FTE_40_linha =</span> FTE_40_direto <span class="sc">*</span> <span class="fl">0.80</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>oferta_brasil <span class="sc">|&gt;</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    ibge nivel profissional SUS                          CATEGORIA    CH  fte40
1 110020   APS         2232   0                 Cirurgião-dentista    40   1.00
2 110020   APS         2232   1                 Cirurgião-dentista  3930  98.25
3 110020   APS         3224   0 Técnico ou Auxiliar de Saúde Bucal    20   0.50
4 110020   APS         3224   1 Técnico ou Auxiliar de Saúde Bucal  3930  98.25
5 110020   AES         2232   0                 Cirurgião-dentista 11341 283.53
6 110020   AES         2232   1                 Cirurgião-dentista  1900  47.50
  FTE_40_direto FTE_40_linha
1         0.800       0.6400
2        78.600      62.8800
3         0.400       0.3200
4        78.600      62.8800
5       226.824     181.4592
6        38.000      30.4000</code></pre>
</div>
</div>
</section>
<section id="implicações-de-resultados-em-termos-quantitativos" class="level3">
<h3 class="anchored" data-anchor-id="implicações-de-resultados-em-termos-quantitativos">4.3. Implicações de resultados em termos quantitativos</h3>
<p>Por fim, são feitos os cálculos entre oferta e necessidade. São aplicadas duas métricas:</p>
<ul>
<li><p>Resultado Absoluto (RA), que é referente à diferença entre oferta e necessidade, conforme equação 4;</p></li>
<li><p>Resultado Relativo (RR), que se refere à diferença percentual entre oferta e necessidade, conforme equação 5.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/eq4_sb.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Onde:</p>
<ul>
<li>RA = Resultado absoluto;</li>
<li>O = Oferta de cirurgiões-dentistas em dada localidade l;</li>
<li>NPSB = Necessidade de cirurgiões-dentistas em dada localidade l;</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/eq5_sb.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Onde:</p>
<ul>
<li>RR = Resultado relativo;</li>
<li>O = Oferta de cirurgiões-dentistas em dada localidade l;</li>
<li>NPSB = Necessidade de cirurgiões-dentistas em dada localidade l;</li>
</ul>
<p>Os cálculos são realizados conforme os scripts:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>oferta_brasil_cd <span class="ot">&lt;-</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>          oferta_brasil <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(profissional <span class="sc">==</span> <span class="st">"2232"</span> <span class="sc">&amp;</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                     SUS <span class="sc">==</span> <span class="st">"1"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>cd_oferta_vs_demanda_br <span class="ot">&lt;-</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  necessidades_prof_br <span class="sc">|&gt;</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(oferta_brasil_cd, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_municipiodv"</span><span class="ot">=</span><span class="st">"ibge"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"nivel"</span> <span class="ot">=</span> <span class="st">"nivel"</span>)) </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>cd_oferta_vs_demanda_br<span class="sc">$</span>FTE_40_linha[<span class="fu">is.na</span>(cd_oferta_vs_demanda_br<span class="sc">$</span>FTE_40_linha)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>cd_oferta_vs_demanda_br<span class="sc">$</span>fte40[<span class="fu">is.na</span>(cd_oferta_vs_demanda_br<span class="sc">$</span>fte40)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>cd_oferta_vs_demanda_br<span class="sc">$</span>FTE_40_direto[<span class="fu">is.na</span>(cd_oferta_vs_demanda_br<span class="sc">$</span>FTE_40_direto)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>cd_oferta_vs_demanda_br <span class="ot">&lt;-</span> </span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  cd_oferta_vs_demanda_br <span class="sc">|&gt;</span> </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ra =</span> FTE_40_linha <span class="sc">-</span> necessidade, </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">rr =</span> (FTE_40_linha<span class="sc">/</span>necessidade) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">ra_s =</span> FTE_40_linha <span class="sc">-</span> necessidade_sus,</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">rr_s =</span> (FTE_40_linha<span class="sc">/</span>necessidade_sus) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ra =</span> <span class="fu">round</span>(ra, <span class="dv">2</span>),</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">rr =</span> <span class="fu">round</span>(rr, <span class="dv">2</span>),</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">ra_s =</span> <span class="fu">round</span>(ra_s, <span class="dv">2</span>),</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">rr_s =</span> <span class="fu">round</span>(rr_s, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">necessidade =</span> <span class="fu">round</span>(necessidade, <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FTE_40_linha =</span> <span class="fu">round</span>(FTE_40_linha, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ibge, municipio, </span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>         nivel, necessidade, necessidade_sus,</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>         FTE_40_linha, rr, ra, rr_s, ra_s, cod_municipiodv, </span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>         cod_mun_loc)</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>cd_oferta_vs_demanda_br <span class="sc">|&gt;</span> </span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>cod_mun_loc,</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>           <span class="sc">-</span>cod_municipiodv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `cod_municipiodv`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,140 × 11
# Groups:   ibge, municipio, nivel, cod_municipiodv [11,140]
   cod_municipiodv ibge   municipio       nivel necessidade necessidade_sus
   &lt;chr&gt;           &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;       &lt;dbl&gt;           &lt;dbl&gt;
 1 110020          110020 Porto Velho     AES        138.            113.  
 2 110020          110020 Porto Velho     APS        431.            369.  
 3 120040          120040 Rio Branco      AES        166.            158.  
 4 120040          120040 Rio Branco      APS        221.            212.  
 5 150010          130000 Abaetetuba      AES         62.7            58.9 
 6 150010          130000 Abaetetuba      APS        160.            152.  
 7 150013          130000 Abel Figueiredo AES          2.54            2.2 
 8 150013          130000 Abel Figueiredo APS          5.98            5.23
 9 170025          130000 Abreulândia     AES          2.3             2.09
10 170025          130000 Abreulândia     APS          4.91            4.63
# ℹ 11,130 more rows
# ℹ 5 more variables: FTE_40_linha &lt;dbl&gt;, rr &lt;dbl&gt;, ra &lt;dbl&gt;, rr_s &lt;dbl&gt;,
#   ra_s &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Vamos gerar a visualização usando um mapa cloroplético por região de saúde. Para isso, precisamos, primeiramente fazer um tratamento para agregar os resultados por regiões de saúde.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lendo a base de hierarquia de localidades para juntar os municipios as respectivas regioes de saude e assim agregar os dados por regiao de saude</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>hierarquia_municipios <span class="ot">&lt;-</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"~/GitHub/saude_bucal/01_dados/hierarquia_atualizada.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5570 Columns: 18
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (12): regiao_pad, regiao, uf_pad, uf, uf_sigla, macrorregiao_pad, macror...
dbl  (6): cod_uf, cod_macrorregiao, cod_regsaud, cod_municipio, cod_municipi...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>hierarquia <span class="ot">&lt;-</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>          hierarquia_municipios <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(cod_municipiodv, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                 uf_sigla, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                 regiao,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                 cod_regsaud,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                 regiao_saude)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>hierarquia<span class="sc">$</span>cod_municipiodv <span class="ot">&lt;-</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>(hierarquia<span class="sc">$</span>cod_municipiodv)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>cd_oferta_vs_demanda_regiao_saude <span class="ot">&lt;-</span> </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  cd_oferta_vs_demanda_br <span class="sc">|&gt;</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(hierarquia, </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_mun_loc"</span><span class="ot">=</span><span class="st">"cod_municipiodv"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(nivel, cod_regsaud, uf_sigla,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>             regiao_saude) <span class="sc">|&gt;</span> </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">necessidade =</span> <span class="fu">sum</span>(necessidade),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">necessidade_sus =</span> <span class="fu">sum</span>(necessidade_sus),</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">oferta =</span> <span class="fu">sum</span>(FTE_40_linha)) <span class="sc">|&gt;</span> </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ra =</span> oferta <span class="sc">-</span> necessidade, </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">rr =</span> (oferta<span class="sc">/</span>necessidade) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">ra_s =</span> oferta <span class="sc">-</span> necessidade_sus,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">rr_s =</span> (oferta<span class="sc">/</span>necessidade_sus) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ra =</span> <span class="fu">round</span>(ra, <span class="dv">2</span>),</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">rr =</span> <span class="fu">round</span>(rr, <span class="dv">2</span>),</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">ra_s =</span> <span class="fu">round</span>(ra_s, <span class="dv">2</span>),</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">rr_s =</span> <span class="fu">round</span>(rr_s, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rr =</span> <span class="fu">if_else</span>(rr <span class="sc">==</span> <span class="fl">0.00</span>, <span class="fl">0.01</span>, rr)) <span class="sc">|&gt;</span> </span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rr_s =</span> <span class="fu">if_else</span>(rr_s <span class="sc">==</span> <span class="fl">0.00</span>, <span class="fl">0.01</span>, rr_s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'nivel', 'cod_regsaud', 'uf_sigla'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<p>A partir daqui temos os mapas</p>
<p>Script para criar o mapa de regiões de saúde.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>estados_br <span class="ot">&lt;-</span> <span class="fu">read_state</span>(<span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">showProgress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>spdf <span class="ot">&lt;-</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geojson_read</span>(<span class="st">"~/GitHub/saude_bucal/01_dados/shape_file_regioes_saude.json"</span>, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">what =</span> <span class="st">"sp"</span>) </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>spdf_fortified <span class="ot">&lt;-</span> </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(spdf)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir limites de longitude e latitude para focar no Brasil</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>limite_long <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">75</span>, <span class="sc">-</span><span class="dv">28</span>)  <span class="co"># limites de longitude</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>limite_lat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">33</span>, <span class="dv">4</span>)     <span class="co"># limites de latitude</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar o mapa</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>mapa_rs <span class="ot">&lt;-</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  cd_oferta_vs_demanda_regiao_saude <span class="sc">|&gt;</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(spdf_fortified, </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_regsaud"</span><span class="ot">=</span><span class="st">"reg_id"</span>)) </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionar geometria se não existir</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">"geometry"</span> <span class="sc">%in%</span> <span class="fu">names</span>(mapa_rs)) {</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  mapa_rs <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(mapa_rs, </span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, </span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"latitude"</span>), </span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs =</span> <span class="dv">4326</span>) </span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="mapa-para-toda-a-população" class="level4">
<h4 class="anchored" data-anchor-id="mapa-para-toda-a-população">4.3.1. Mapa para toda a população</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapa_rs <span class="sc">|&gt;</span> <span class="fu">filter</span>(nivel <span class="sc">==</span> <span class="st">"APS"</span>), </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> rr, <span class="at">geometry =</span> geometry), </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"#e9e9e9"</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> estados_br, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="cn">NA</span>, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"#4c4d4a"</span>, </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#D92B3A"</span>, </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"#d4e302"</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"#02592e"</span>), </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values =</span> </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rescale</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>,<span class="dv">70</span>)), </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">70</span>),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">35</span>, <span class="dv">70</span>)) <span class="sc">+</span> </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Relative gap"</span>) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),  </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="co">#  annotation_north_arrow(location = "tr",  </span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                         which_north = "true",</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                         style = north_arrow_fancy_orienteering()) +</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"bl"</span>,  </span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">width_hint =</span> <span class="fl">0.3</span>)  <span class="sc">+</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Primary Healthcare"</span>)</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapa_rs <span class="sc">|&gt;</span> <span class="fu">filter</span>(nivel <span class="sc">==</span> <span class="st">"AES"</span>), </span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> rr, <span class="at">geometry =</span> geometry), </span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"#e9e9e9"</span>) <span class="sc">+</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> estados_br, </span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="cn">NA</span>, </span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"#4c4d4a"</span>, </span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#D92B3A"</span>, </span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"#d4e302"</span>,</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"#02592e"</span>), </span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values =</span> </span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rescale</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="dv">165</span>)), </span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">165</span>),</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">160</span>)) <span class="sc">+</span> </span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Relative gap"</span>) <span class="sc">+</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),  </span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"tr"</span>,  </span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>                         <span class="at">which_north =</span> <span class="st">"true"</span>,</span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>                         <span class="at">style =</span> <span class="fu">north_arrow_fancy_orienteering</span>()) <span class="sc">+</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a><span class="co">#  annotation_scale(location = "bl",  </span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a><span class="co">#                   width_hint = 0.3)  +</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Specialized Healthcare"</span>)</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> a <span class="sc">+</span> b</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(filename = "mapas.jpeg", </span></span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a><span class="co">#       plot = c,</span></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a><span class="co">#       dpi = 400, </span></span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a><span class="co">#       width = 16, </span></span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a><span class="co">#       height = 10)</span></span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale on map varies by more than 10%, scale bar may be inaccurate</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_br_saude_bucal_tese_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mapa-para-população-sus-dependente" class="level4">
<h4 class="anchored" data-anchor-id="mapa-para-população-sus-dependente">4.3.2. Mapa para população SUS dependente</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapa_rs <span class="sc">|&gt;</span> <span class="fu">filter</span>(nivel <span class="sc">==</span> <span class="st">"APS"</span>), </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> rr_s, <span class="at">geometry =</span> geometry), </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"#e9e9e9"</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> estados_br, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="cn">NA</span>, </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"#4c4d4a"</span>, </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#D92B3A"</span>, </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"#d4e302"</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"#02592e"</span>), </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values =</span> </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rescale</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>)), </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Relative gap"</span>) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),  </span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co">#  annotation_north_arrow(location = "tr",  </span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                         which_north = "true",</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                         style = north_arrow_fancy_orienteering()) +</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"bl"</span>,  </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">width_hint =</span> <span class="fl">0.3</span>)  <span class="sc">+</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Primary Healthcare"</span>)</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapa_rs <span class="sc">|&gt;</span> <span class="fu">filter</span>(nivel <span class="sc">==</span> <span class="st">"AES"</span>), </span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> rr_s, <span class="at">geometry =</span> geometry), </span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"#e9e9e9"</span>) <span class="sc">+</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> estados_br, </span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="cn">NA</span>, </span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"#4c4d4a"</span>, </span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#D92B3A"</span>, </span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"#d4e302"</span>,</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"#02592e"</span>), </span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values =</span> </span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rescale</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="dv">195</span>)), </span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">195</span>),</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">195</span>)) <span class="sc">+</span> </span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Relative gap"</span>) <span class="sc">+</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),  </span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"tr"</span>,  </span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>                         <span class="at">which_north =</span> <span class="st">"true"</span>,</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>                         <span class="at">style =</span> <span class="fu">north_arrow_fancy_orienteering</span>()) <span class="sc">+</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a><span class="co">#  annotation_scale(location = "bl",  </span></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a><span class="co">#                   width_hint = 0.3)  +</span></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Specialized Healthcare"</span>)</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> z <span class="sc">+</span> x</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(filename = "mapas_sus.jpeg", </span></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a><span class="co">#       plot = w,</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a><span class="co">#       dpi = 400, </span></span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a><span class="co">#       width = 16, </span></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a><span class="co">#       height = 10)</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale on map varies by more than 10%, scale bar may be inaccurate</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_br_saude_bucal_tese_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="implicações-de-resultados-em-termos-financeiros" class="level3">
<h3 class="anchored" data-anchor-id="implicações-de-resultados-em-termos-financeiros">4.4. Implicações de resultados em termos financeiros</h3>
<p>Ao final, sugere-se o cálculo do impacto financeiro desta lacuna. Isso pode ser feito multiplicando o RA ao salário médio de cirurgiões dentistas em Palmas-TO adicionado a um custo trabalhista.</p>
<p>De acordo com dados da Pesquisa Nacional de Amostragem por Domicílio contínua (PNADc) do Instituto Brasileiro de Geografia e Estatística (IBGE), o salário médio é na ordem de R$ 4000. Adicionado a um fator para adicionar o custo trabalhista (1.42), tem-se os resultados na tabela a seguir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#custo_palmas &lt;- </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  oferta_vs_demanda |&gt; </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(custo_mensal = ra * (-1) * (4000 * 1.42)) |&gt; </span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  select(ibge, municipio, nivel, CATEGORIA,</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#         custo_mensal)</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#custo_palmas </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="análise-de-cenário" class="level2">
<h2 class="anchored" data-anchor-id="análise-de-cenário">5. Análise de Cenário</h2>
<p>Uma das últimas etapas do desenvolvimento de metodologias consiste na análise de cenário. Esta etapa é realizada, pois nem sempre temos parâmetros certos. Portanto, a análise é usada para simular a metodologia com diferentes parâmetros.</p>
<p>Criamos uma função para iterar sobre alguns valores. Isso permitirá visualizar o impacto da mudança neles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>gap_necessidade_oferta <span class="ot">&lt;-</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(tempo_aps, tempo_endo, tempo_prot, tempo_peri, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>           ttd, pd, pl, sus, categoria, plano){</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    pop_brasil_tratado <span class="ot">&lt;-</span> </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>      pop_brasil <span class="sc">|&gt;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">uf =</span> <span class="fu">substr</span>(cod_municipiodv, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(cod_municipiodv, </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>             ibge_sb, municipio, de_0_a_14_anos,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>             de_15_a_29_anos, de_30_a_59_anos,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>             acima_de_60_anos) <span class="sc">|&gt;</span> </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"faixa"</span>, </span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">value =</span> <span class="st">"total"</span>,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>             <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">faixa =</span> <span class="fu">gsub</span>(<span class="st">"_"</span>,<span class="st">" "</span>,faixa)) <span class="sc">|&gt;</span> </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">ibge =</span> <span class="fu">as.character</span>(ibge_sb)) <span class="sc">|&gt;</span> </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">ibge =</span> <span class="fu">substr</span>(ibge_sb, <span class="dv">1</span>, <span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">cod_municipiodv =</span> </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.character</span>(cod_municipiodv)) <span class="sc">|&gt;</span> </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">cod_mun_loc =</span> cod_municipiodv) <span class="sc">|&gt;</span> </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">cod_municipiodv =</span> </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>               <span class="fu">substr</span>(cod_municipiodv, <span class="dv">1</span>, <span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">id_faixa =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>        faixa <span class="sc">==</span> <span class="st">"de 0 a 14 anos"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>        faixa <span class="sc">==</span> <span class="st">"de 15 a 29 anos"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>        faixa <span class="sc">==</span> <span class="st">"de 30 a 59 anos"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>        faixa <span class="sc">==</span> <span class="st">"acima de 60 anos"</span> <span class="sc">~</span> <span class="dv">4</span>))</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    pop_brasil_tratado <span class="ot">&lt;-</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>      pop_brasil_tratado <span class="sc">|&gt;</span> </span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">ibge_sb =</span> <span class="fu">as.character</span>(ibge_sb)) <span class="sc">|&gt;</span> </span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">ibge_sb =</span> <span class="fu">str_sub</span>(ibge_sb, </span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>                               <span class="at">start =</span> <span class="dv">1</span>, </span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>                               <span class="at">end =</span> <span class="dv">6</span>))</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>    populacao_tratado <span class="ot">&lt;-</span> </span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>      pop_brasil_tratado <span class="sc">|&gt;</span> </span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(relacao_municipio_rs,</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_municipiodv"</span><span class="ot">=</span><span class="st">"cod_municipio"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(plano_odontologico_rs,</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_regsaud"</span>,</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"id_faixa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>benef, <span class="sc">-</span>pop) <span class="sc">|&gt;</span> </span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">pop_sus =</span> total <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> cobertura_plano))</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>    cobertura_sb<span class="sc">$</span>ibge <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cobertura_sb<span class="sc">$</span>ibge)</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>    pop_coberta_br <span class="ot">&lt;-</span> </span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>      populacao_tratado <span class="sc">|&gt;</span> </span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(cobertura_sb, </span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ibge_sb"</span> <span class="ot">=</span> <span class="st">"ibge"</span>,</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"id_faixa"</span> <span class="ot">=</span> <span class="st">"id_faixa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(ibge, ibge_sb, </span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>             municipio.x, </span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>             faixa, id_faixa, </span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>             total, procedimento, cobertura, cobertura_plano,</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>             pop_sus, cod_municipiodv, cod_mun_loc) <span class="sc">|&gt;</span> </span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">municipio =</span> municipio.x) <span class="sc">|&gt;</span> </span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">cobertura_servicos =</span> cobertura) <span class="sc">|&gt;</span> </span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">populacao_coberta =</span> cobertura_servicos <span class="sc">*</span> total) <span class="sc">|&gt;</span> </span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">populacao_coberta =</span> <span class="fu">round</span>(populacao_coberta, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">populacao_coberta_sus =</span> cobertura_servicos <span class="sc">*</span> pop_sus) <span class="sc">|&gt;</span> </span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">populacao_coberta_sus =</span> <span class="fu">round</span>(populacao_coberta_sus, <span class="dv">2</span>))</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>    producao_brasil <span class="ot">&lt;-</span> producao_normativa_br <span class="sc">|&gt;</span> </span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>municipio, </span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>             <span class="sc">-</span>li_cobertura,</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>             <span class="sc">-</span>ls_cobertura,</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>             <span class="sc">-</span>faixa_etaria)</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>    necessidades_servicos_br <span class="ot">&lt;-</span> </span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>      pop_coberta_br <span class="sc">|&gt;</span> </span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(producao_brasil, </span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ibge"</span> <span class="ot">=</span> <span class="st">"ibge"</span>,</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"id_faixa"</span>,</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"procedimento"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">nec_servicos =</span> </span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>               populacao_coberta <span class="sc">*</span> producao_pc) <span class="sc">|&gt;</span> </span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">nec_servicos =</span> </span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(nec_servicos, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">nec_servicos_sus =</span> </span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>               populacao_coberta_sus <span class="sc">*</span> producao_pc) <span class="sc">|&gt;</span> </span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">nec_servicos_sus =</span> <span class="fu">round</span>(nec_servicos_sus,<span class="dv">2</span>))</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a>    necessidades_prof_br <span class="ot">&lt;-</span> </span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a>      necessidades_servicos_br <span class="sc">|&gt;</span></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">nec_prof =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a>        procedimento <span class="sc">==</span> <span class="st">"Atenção Básica"</span> <span class="sc">~</span> (nec_servicos <span class="sc">*</span> tempo_aps<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>        procedimento <span class="sc">==</span> <span class="st">"Endodontia"</span> <span class="sc">~</span> (nec_servicos <span class="sc">*</span> tempo_endo<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a>        procedimento <span class="sc">==</span> <span class="st">"Periodontia"</span> <span class="sc">~</span> (nec_servicos <span class="sc">*</span> tempo_peri<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>        procedimento <span class="sc">==</span> <span class="st">"Prótese"</span> <span class="sc">~</span> (nec_servicos <span class="sc">*</span> tempo_prot<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">nec_prof_sus =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a>        procedimento <span class="sc">==</span> <span class="st">"Atenção Básica"</span> <span class="sc">~</span> (nec_servicos_sus <span class="sc">*</span> tempo_aps<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>        procedimento <span class="sc">==</span> <span class="st">"Endodontia"</span> <span class="sc">~</span> (nec_servicos_sus <span class="sc">*</span> tempo_endo<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a>        procedimento <span class="sc">==</span> <span class="st">"Periodontia"</span> <span class="sc">~</span> (nec_servicos_sus <span class="sc">*</span> tempo_peri<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>,</span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a>        procedimento <span class="sc">==</span> <span class="st">"Prótese"</span> <span class="sc">~</span> (nec_servicos_sus <span class="sc">*</span> tempo_prot<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">1576</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">nivel =</span> <span class="fu">if_else</span>(procedimento <span class="sc">==</span> <span class="st">"Atenção Básica"</span>,</span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"APS"</span>,</span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"AES"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(ibge, municipio, </span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a>               nivel, cod_municipiodv, </span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a>               cod_mun_loc) <span class="sc">|&gt;</span> </span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">necessidade =</span> <span class="fu">sum</span>(nec_prof),</span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a>                <span class="at">necessidade_sus =</span> <span class="fu">sum</span>(nec_prof_sus)) <span class="sc">|&gt;</span> </span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">necessidade =</span> <span class="fu">round</span>(necessidade, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">necessidade_sus =</span> <span class="fu">round</span>(necessidade_sus, <span class="dv">2</span>))</span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a>    oferta_prof <span class="ot">&lt;-</span> oferta_brasil <span class="sc">|&gt;</span> </span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(profissional <span class="sc">==</span> categoria)</span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a>    todos <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Se sus = TRUE vai pegar apenas aqueles profissionais com vínculo SUS</span></span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># Se SUS = FALSE vai pegar todos os profissionais independente do vínculo</span></span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a>    oferta_temp <span class="ot">&lt;-</span> </span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(todos <span class="sc">==</span> sus)</span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a>        oferta_prof <span class="sc">|&gt;</span> </span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(SUS <span class="sc">==</span> <span class="st">"1"</span>) </span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a>      } </span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a>      oferta_prof <span class="sc">|&gt;</span> </span>
<span id="cb39-124"><a href="#cb39-124" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(ibge, profissional, nivel) <span class="sc">|&gt;</span> </span>
<span id="cb39-125"><a href="#cb39-125" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">fte40 =</span> <span class="fu">sum</span>(fte40)) <span class="sc">|&gt;</span> </span>
<span id="cb39-126"><a href="#cb39-126" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>()</span>
<span id="cb39-127"><a href="#cb39-127" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb39-128"><a href="#cb39-128" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb39-129"><a href="#cb39-129" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-130"><a href="#cb39-130" aria-hidden="true" tabindex="-1"></a>    oferta_temp<span class="sc">$</span>fte40[<span class="fu">is.na</span>(oferta_temp<span class="sc">$</span>fte40)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-131"><a href="#cb39-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-132"><a href="#cb39-132" aria-hidden="true" tabindex="-1"></a>    oferta_temp <span class="ot">&lt;-</span> </span>
<span id="cb39-133"><a href="#cb39-133" aria-hidden="true" tabindex="-1"></a>      oferta_temp <span class="sc">|&gt;</span> </span>
<span id="cb39-134"><a href="#cb39-134" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">FTE_40_direto =</span> fte40 <span class="sc">*</span> pd) <span class="sc">|&gt;</span> </span>
<span id="cb39-135"><a href="#cb39-135" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">FTE_40_linha =</span> FTE_40_direto <span class="sc">*</span> pl)</span>
<span id="cb39-136"><a href="#cb39-136" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-137"><a href="#cb39-137" aria-hidden="true" tabindex="-1"></a>    oferta_temp<span class="sc">$</span>FTE_40_direto[<span class="fu">is.na</span>(oferta_temp<span class="sc">$</span>FTE_40_direto)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-138"><a href="#cb39-138" aria-hidden="true" tabindex="-1"></a>    oferta_temp<span class="sc">$</span>FTE_40_linha[<span class="fu">is.na</span>(oferta_temp<span class="sc">$</span>FTE_40_linha)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-139"><a href="#cb39-139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-140"><a href="#cb39-140" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-141"><a href="#cb39-141" aria-hidden="true" tabindex="-1"></a>    flag <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb39-142"><a href="#cb39-142" aria-hidden="true" tabindex="-1"></a>    <span class="co"># se flag = 1, vamos trabalhar com as necessidades todos</span></span>
<span id="cb39-143"><a href="#cb39-143" aria-hidden="true" tabindex="-1"></a>    <span class="co"># se flag = 0, vamos trabalhar com as necessidades daqueles sus dependentes</span></span>
<span id="cb39-144"><a href="#cb39-144" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-145"><a href="#cb39-145" aria-hidden="true" tabindex="-1"></a>    flag <span class="ot">&lt;-</span> plano</span>
<span id="cb39-146"><a href="#cb39-146" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-147"><a href="#cb39-147" aria-hidden="true" tabindex="-1"></a>    oferta_vs_demanda <span class="ot">&lt;-</span></span>
<span id="cb39-148"><a href="#cb39-148" aria-hidden="true" tabindex="-1"></a>      necessidades_prof_br <span class="sc">|&gt;</span> </span>
<span id="cb39-149"><a href="#cb39-149" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(oferta_temp, </span>
<span id="cb39-150"><a href="#cb39-150" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_municipiodv"</span><span class="ot">=</span><span class="st">"ibge"</span>,</span>
<span id="cb39-151"><a href="#cb39-151" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"nivel"</span> <span class="ot">=</span> <span class="st">"nivel"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-152"><a href="#cb39-152" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">ra =</span> <span class="fu">if_else</span>(flag <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb39-153"><a href="#cb39-153" aria-hidden="true" tabindex="-1"></a>                          FTE_40_linha <span class="sc">-</span> necessidade, </span>
<span id="cb39-154"><a href="#cb39-154" aria-hidden="true" tabindex="-1"></a>                          FTE_40_linha <span class="sc">-</span> necessidade_sus)) <span class="sc">|&gt;</span></span>
<span id="cb39-155"><a href="#cb39-155" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">rr =</span> <span class="fu">if_else</span>(flag <span class="sc">==</span> <span class="dv">0</span>, </span>
<span id="cb39-156"><a href="#cb39-156" aria-hidden="true" tabindex="-1"></a>                          FTE_40_linha<span class="sc">/</span>necessidade, </span>
<span id="cb39-157"><a href="#cb39-157" aria-hidden="true" tabindex="-1"></a>                          FTE_40_linha<span class="sc">/</span>necessidade_sus)) <span class="sc">|&gt;</span></span>
<span id="cb39-158"><a href="#cb39-158" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">ra =</span> <span class="fu">round</span>(ra, <span class="dv">2</span>),</span>
<span id="cb39-159"><a href="#cb39-159" aria-hidden="true" tabindex="-1"></a>             <span class="at">rr =</span> <span class="fu">round</span>(rr, <span class="dv">2</span>)) </span>
<span id="cb39-160"><a href="#cb39-160" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-161"><a href="#cb39-161" aria-hidden="true" tabindex="-1"></a>    oferta_vs_demanda <span class="ot">&lt;-</span> oferta_vs_demanda <span class="sc">|&gt;</span></span>
<span id="cb39-162"><a href="#cb39-162" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">necessidade =</span> <span class="fu">round</span>(necessidade, <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb39-163"><a href="#cb39-163" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">FTE_40_linha =</span> <span class="fu">round</span>(FTE_40_linha, <span class="dv">2</span>)) </span>
<span id="cb39-164"><a href="#cb39-164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-165"><a href="#cb39-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-166"><a href="#cb39-166" aria-hidden="true" tabindex="-1"></a><span class="do">### falta colocar as flags aqui para pegar a população SUS dependente </span></span>
<span id="cb39-167"><a href="#cb39-167" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-168"><a href="#cb39-168" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-169"><a href="#cb39-169" aria-hidden="true" tabindex="-1"></a>    cd_oferta_vs_demanda_regiao_saude <span class="ot">&lt;-</span> </span>
<span id="cb39-170"><a href="#cb39-170" aria-hidden="true" tabindex="-1"></a>    cd_oferta_vs_demanda_br <span class="sc">|&gt;</span></span>
<span id="cb39-171"><a href="#cb39-171" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(hierarquia, </span>
<span id="cb39-172"><a href="#cb39-172" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_mun_loc"</span><span class="ot">=</span><span class="st">"cod_municipiodv"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-173"><a href="#cb39-173" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(nivel, cod_regsaud, uf_sigla,</span>
<span id="cb39-174"><a href="#cb39-174" aria-hidden="true" tabindex="-1"></a>               regiao_saude) <span class="sc">|&gt;</span> </span>
<span id="cb39-175"><a href="#cb39-175" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">necessidade =</span> <span class="fu">sum</span>(necessidade),</span>
<span id="cb39-176"><a href="#cb39-176" aria-hidden="true" tabindex="-1"></a>                <span class="at">necessidade_sus =</span> <span class="fu">sum</span>(necessidade_sus),</span>
<span id="cb39-177"><a href="#cb39-177" aria-hidden="true" tabindex="-1"></a>                <span class="at">oferta =</span> <span class="fu">sum</span>(FTE_40_linha)) <span class="sc">|&gt;</span> </span>
<span id="cb39-178"><a href="#cb39-178" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">ra =</span> <span class="fu">if_else</span>(flag <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb39-179"><a href="#cb39-179" aria-hidden="true" tabindex="-1"></a>                          oferta <span class="sc">-</span> necessidade, </span>
<span id="cb39-180"><a href="#cb39-180" aria-hidden="true" tabindex="-1"></a>                          oferta <span class="sc">-</span> necessidade_sus)) <span class="sc">|&gt;</span> </span>
<span id="cb39-181"><a href="#cb39-181" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">rr =</span> <span class="fu">if_else</span>(flag <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb39-182"><a href="#cb39-182" aria-hidden="true" tabindex="-1"></a>                          oferta<span class="sc">/</span>necessidade, </span>
<span id="cb39-183"><a href="#cb39-183" aria-hidden="true" tabindex="-1"></a>                          oferta<span class="sc">/</span>necessidade_sus)) <span class="sc">|&gt;</span> </span>
<span id="cb39-184"><a href="#cb39-184" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">ra =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> ra, <span class="dv">2</span>),</span>
<span id="cb39-185"><a href="#cb39-185" aria-hidden="true" tabindex="-1"></a>             <span class="at">rr =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> rr, <span class="dv">2</span>))<span class="sc">|&gt;</span> </span>
<span id="cb39-186"><a href="#cb39-186" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">rr =</span> <span class="fu">if_else</span>(rr <span class="sc">==</span> <span class="fl">0.00</span>, <span class="fl">0.01</span>, rr)) </span>
<span id="cb39-187"><a href="#cb39-187" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-188"><a href="#cb39-188" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-189"><a href="#cb39-189" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-190"><a href="#cb39-190" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="executando-a-função-para-um-conjunto-de-valores" class="level4">
<h4 class="anchored" data-anchor-id="executando-a-função-para-um-conjunto-de-valores">5.1. Executando a função para um conjunto de valores</h4>
<p>Utilizamos uma lista de valores para iterar conforme a tabela abaixo. Estas combinações resultaram em 1600 combinações de resultados.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Parâmetro</th>
<th>Sigla</th>
<th>Valores</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tempo total disponível</td>
<td>TTD</td>
<td>em horas: 1576; 1676; 1776; 1876</td>
</tr>
<tr class="even">
<td>Tempo de procedimentos</td>
<td>T</td>
<td>em minutos: 25, 35, 45, 55</td>
</tr>
<tr class="odd">
<td>Percentual de atividades diretas</td>
<td>PD</td>
<td>em unidade percentual: 50%, 60%, 80%, 90%, 100%</td>
</tr>
<tr class="even">
<td>Percentual de atividades da linha de cuidado</td>
<td>PL</td>
<td>em unidade percentual: 50%, 60%, 80%, 90%, 100%</td>
</tr>
<tr class="odd">
<td>Categoria profissional</td>
<td>CAT</td>
<td>Cirurgião-dentista e Técnico/Auxiliar de Saúde Bucal</td>
</tr>
<tr class="even">
<td>Recorte de Profissionais</td>
<td>SUS</td>
<td>TRUE (pegar todos profissionais, SUS e não SUS) ou FALSE (pegar só os profissionais SUS)</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando lista de vetores para cada parâmetro</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>list_ttd <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="st">"1576"</span>, <span class="st">"1676"</span>, <span class="st">"1776"</span>, <span class="st">"1876"</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>list_tempo <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="st">"25"</span>,<span class="st">"35"</span>, <span class="st">"45"</span>, <span class="st">"55"</span>, <span class="st">"65"</span>, <span class="st">"75"</span>))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>list_pd <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="st">"0.50"</span>, <span class="st">"0.60"</span>,<span class="st">"0.70"</span>, <span class="st">"0.80"</span>, <span class="st">"0.90"</span>, <span class="st">"1"</span>))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>list_pl <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="st">"0.50"</span>, <span class="st">"0.60"</span>, <span class="st">"0.70"</span>, <span class="st">"0.80"</span>, <span class="st">"0.90"</span>, <span class="st">"1"</span>))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>list_cat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"2232"</span>)<span class="co">#,"3224")</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>list_sus <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>) <span class="co"># pegar todos os profissionais (FALSE) ou só SUS (TRUE)</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>resultado1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>iteracao1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>total_iteracoes1 <span class="ot">&lt;-</span> </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(list_ttd) <span class="sc">*</span> <span class="fu">length</span>(list_tempo) <span class="sc">*</span> <span class="fu">length</span>(list_pd) <span class="sc">*</span> </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(list_pl) <span class="sc">*</span> <span class="fu">length</span>(list_cat) <span class="sc">*</span> <span class="fu">length</span>(list_sus)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ttd <span class="cf">in</span> list_ttd) {</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (tempo <span class="cf">in</span> list_tempo) {</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (pd <span class="cf">in</span> list_pd) {</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (pl <span class="cf">in</span> list_pl) { </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(sus <span class="cf">in</span> list_sus){</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span>(cat <span class="cf">in</span> list_cat){</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>            iteracao1 <span class="ot">&lt;-</span> iteracao1 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">"Iteração:"</span>, iteracao1, <span class="st">"de"</span>, total_iteracoes1, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>            res1 <span class="ot">&lt;-</span> </span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">gap_necessidade_oferta</span>(</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">tempo =</span> tempo, </span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">ttd =</span> ttd, </span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">pd =</span> pd, </span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">pl =</span> pl,</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">sus =</span> sus, </span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">cat =</span> cat)</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>            res1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(res1, </span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ttd =</span> ttd, </span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>                         <span class="at">tempo =</span> tempo, </span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>                         <span class="at">pd =</span> pd, </span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>                         <span class="at">pl =</span> pl,</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sus =</span> sus,</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cat =</span> cat)</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>            res1<span class="sc">$</span>atributos <span class="ot">&lt;-</span> <span class="fu">paste</span>(ttd, </span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>                                   tempo, </span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>                                   pd, </span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>                                   pl, </span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>                                   sus,</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>                                   cat, </span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>            resultado1[[<span class="fu">length</span>(resultado1) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> res1</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando o tamanho da lista resultado</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(resultado1)</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>resultado_teste1 <span class="ot">&lt;-</span> </span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind, resultado1) </span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>hierarquia_municipios<span class="sc">$</span>cod_municipio <span class="ot">&lt;-</span> </span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>(hierarquia_municipios<span class="sc">$</span>cod_municipio)</span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>resultado <span class="ot">&lt;-</span> </span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>  resultado_teste1 <span class="sc">|&gt;</span></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">categoria =</span> <span class="fu">if_else</span>(profissional <span class="sc">==</span> <span class="st">'2232'</span>,</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Dentista"</span>,<span class="st">"TSB/ASB"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sus =</span> <span class="fu">if_else</span>(sus <span class="sc">==</span> <span class="cn">TRUE</span>, </span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Apenas SUS"</span>, <span class="st">"Todos"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(hierarquia_municipios, </span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cod_municipiodv"</span><span class="ot">=</span><span class="st">"cod_municipio"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cod_municipiodv, regiao, uf_sigla, uf, municipio, </span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>         regiao_saude, cod_regsaud, nivel, profissional, </span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>         categoria, sus, necessidade, fte40, FTE_40_direto, </span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>         FTE_40_linha, ra, rr, ttd, tempo, pd, pl, atributos)</span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv2(resultado, "resultado_final_1600.csv")</span></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a><span class="co">#arrow::write_parquet(resultado, "resultado_final_1600.parquet")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Estas iterações resultaram em 1600 combinações que levaram a construção de um dataframe com 17.824.000 observações (5570 municípios x 1600 combinações x cálculos de necessidades para 2 níveis de atenção). A apresentação destes resultados ocorrerá por meio de um dashboard.</p>
</section>
</section>
<section id="referências" class="level1">
<h1>Referências</h1>
<p>Asamani, J. A., Christmals, C. D., &amp; Reitsma, G. M. (2021). The needs-based health workforce planning method: a systematic scoping review of analytical applications.&nbsp;<em>Health Policy and Planning</em>,&nbsp;<em>36</em>(8), 1325-1343.</p>
<p>Belotti, L., Maito, S., Vesga-Varela, A. L., de Almeida, L. Y., da Silva, M. T., Haddad, A. E., … &amp; Bonfim, D. (2024). Activities of the oral health teams in primary health care: a time-motion study.&nbsp;<em>BMC Health Services Research</em>,&nbsp;<em>24</em>(1), 617.</p>
<p>Brasil (2017). Portaria de Consolidação nº 1, 28 de setembro de 2017.&nbsp;<em>Consolidação das normas sobre os direitos e deveres dos usuários da saúde, a organização e o funcionamento do Sistema Único de Saúde. Diário Oficial da União</em>.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>